dnl Configure template for the EMBOSS package.
dnl Process this file with autoconf to produce a configure script.

#if you want to force configure to use the default C compiler cc
## then uncomment the following line.
#CC=cc

AC_INIT(ajax/ajacd.c)
AM_INIT_AUTOMAKE(EMBOSS, 2.5.0)


dnl Use libtool to make a shared library.
AM_PROG_LIBTOOL




dnl Define where the EMBOSS package is located
AC_SUBST(AJAX_FIXED_ROOT)
AJAX_FIXED_ROOT="\\\"`pwd`/emboss\\\""
AC_SUBST(EMBOSS_TOP)
EMBOSS_TOP=`pwd`

dnl Program checks
#AC_PROG_CXX
AC_PROG_AWK
AC_PROG_CC
AC_PROG_CPP
AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_MAKE_SET
AC_PROG_RANLIB

dnl Check for header files
AC_PATH_XTRA
AC_HEADER_DIRENT
AC_HEADER_STDC

AC_CHECK_HEADERS(unistd.h)

dnl Check for typedefs, structures and compiler characteristics
AC_C_CONST
AC_TYPE_PID_T
AC_TYPE_SIZE_T
AC_STRUCT_TM

dnl Check for library functions
AC_FUNC_GETPGRP
AC_FUNC_STRFTIME
AC_FUNC_VFORK
AC_FUNC_VPRINTF

AC_CHECK_FUNCS(memmove)

if test "${with_x}" != "no" ; then
LF_EMBOSS_PATH_XLIB
fi

dnl Library checks
AC_CHECK_LIB(c, gethostbyname, LIBS="$LIBS", LIBS="$LIBS -lnsl")
AC_CHECK_LIB(c, socket, LIBS="$LIBS" , LIBS="$LIBS -lsocket")
AC_CHECK_LIB(m, main)

AM_CONDITIONAL(AMPNG, false)
CHECK_PNGDRIVER
CHECK_JAVA
CHECK_JAVAOS
CHECK_AUTH

dnl Test if --enable-corba is given
AC_ARG_ENABLE(corba,
[ --enable-corba	   corba (need glib and orbit)])
if test "${enable_corba}" = "yes" ; then
AC_MSG_CHECKING(for ORBit and glib)
CPPFLAGS="$CPPFLAGS -I/usr/lib/glib/include -I/usr/local/lib/glib/include"

AC_CHECK_HEADERS(glib.h)
AC_CHECK_HEADERS(orb/orbit.h)
AC_CHECK_LIB(glib, main)

AC_CHECK_LIB(ORBitutil, main)
AC_CHECK_LIB(IIOP, main)
AC_CHECK_LIB(ORBit, main)
fi

dnl Test if --enable-debug given
AC_ARG_ENABLE(debug,
[  --enable-debug          debug (-g option on compiler)])
if test "${enable_debug}" = "yes" ; then
  CFLAGS="-g"
fi          


dnl Turn off irritating linker warnings in IRIX
if test "`uname`" = "IRIX"; then
CFLAGS="-Wl,-LD_MSG:off=85:off=84:off=16:off=134 $CFLAGS"
fi




dnl Test if --enable-large is given
AC_ARG_ENABLE(large,
[ --enable-large   large ])
if test "${enable_large}" = "yes" ; then
AC_MSG_CHECKING(for large file support)

dnl Test for Linux large file support
if test "`uname`" = "Linux"; then
CPPFLAGS="-DAJ_LinuxLF -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE $CPPFLAGS"
fi

dnl Test for Solaris large file support
if test "`uname`" = "SunOS"; then
CPPFLAGS="-DAJ_SolarisLF -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE $CPPFLAGS"
fi

dnl Test for OSF1 large file support (its always this anyway)
if test "`uname`" = "OSF1"; then
CPPFLAGS="-DAJ_OSF1LF $CPPFLAGS"
fi

dnl Test for SGI large file support
dnl CPPFLAGS="-DAJ_IRIXLF -D_OFF64_T -D_LFAPI -D_NO_ANSIMODE $CPPFLAGS"
if test "`uname`" = "IRIX"; then
CPPFLAGS="-DAJ_IRIXLF $CPPFLAGS"
fi



AC_MSG_RESULT(done)
fi






dnl Test if --enable-64 is given
AC_ARG_ENABLE(64,
[ --enable-64   64 ])
if test "${enable_64}" = "yes" ; then
AC_MSG_CHECKING(for 64bit compilation support)

dnl Test for Linux 64 bit
if test "`uname`" = "Linux"; then
CPPFLAGS="-DAJ_Linux64 $CPPFLAGS"
fi

dnl Test for Solaris 64 bit
if test "`uname`" = "SunOS"; then
CPPFLAGS="-DAJ_Solaris64 $CPPFLAGS"
fi

dnl Test for OSF1 64 bit (its always this anyway)
if test "`uname`" = "OSF1"; then
CPPFLAGS="-DAJ_OSF164 $CPPFLAGS"
fi

dnl Test for SGI 64 bit
if test "`uname`" = "IRIX"; then
CPPFLAGS="-DAJ_IRIX64 -mabi=64 $CPPFLAGS"
fi

AC_MSG_RESULT(done)
fi







dnl Test if purify exists and if --enable-purify given if so
dnl set "-g" else set "-O"

AC_MSG_CHECKING(for purify)
#if(purify -version) < /dev/null > /dev/null 2>&1; then
   AC_ARG_ENABLE(purify,
   [  --enable-purify          purify ])
if test "${enable_purify}" = "yes" ; then
     CFLAGS="$CFLAGS -g"
     AC_MSG_RESULT(yes)
else
   AC_MSG_RESULT(no)
fi          
#fi


dnl Test if --enable-debug given
AC_ARG_ENABLE(warnings,
[  --enable-warnings          warnings (-Wall option on compiler)])
if test "${enable_warnings}" = "yes" ; then
  CFLAGS="$CFLAGS -Wall"
fi          

dnl Set extra needed compiler flags
if test "$CC" = "cc"; then
  case "$host" in
    alpha*-dec-osf*) CFLAGS="$CFLAGS -ieee";;
  esac
fi
AM_CONDITIONAL(PURIFY, test "${enable_purify}" = "yes")

dnl Tests for AIX
dnl If shared needs -Wl,-G in plplot,ajax,nucleus, -lX11 in plplot,
dnl and -Wl,brtl -Wl,-bdynamic in emboss
dnl We therefore need a static test as well
needajax=no
AM_CONDITIONAL(ISAIXIA64, test "`uname`" = "AIX")
AM_CONDITIONAL(ISSHARED, test "${enable_shared}" = "yes")
AC_SUBST(ISAIXIA64)

if test "`uname`" = "AIX"; then
if test -d ajax/.libs ; then
	echo AIX ajax/.libs exists
else
	mkdir ajax/.libs
fi

#if test "$host_os" = "aix5.1.0.0"; then
#	echo $host_os
#	exit 0
#fi
case $host_os in
	aix5*) needajax=no ;;
	aix4.3.3*) needajax=yes ;;
	*) needajax=no ;;
esac
fi
AM_CONDITIONAL(NEEDAJAX,test "$needajax" = "yes")
AC_SUBST(NEEDAJAX)


dnl HP-UX needs -lsec for shadow passwords
if test "`uname`" = "HP-UX"; then
LDFLAGS="$LDFLAGS -lsec"
fi


dnl check and set compilation flags for Jemboss auth server code
CHECK_THREADS


AC_OUTPUT(plplot/Makefile plplot/lib/Makefile nucleus/Makefile ajax/Makefile
emboss/Makefile emboss/acd/Makefile test/Makefile test/data/Makefile
test/embl/Makefile test/genbank/Makefile test/gb/Makefile
test/pir/Makefile test/swiss/Makefile
test/swnew/Makefile test/wormpep/Makefile emboss/data/Makefile
emboss/data/AAINDEX/Makefile
emboss/data/CODONS/Makefile emboss/data/REBASE/Makefile 
emboss/data/PRINTS/Makefile emboss/data/PROSITE/Makefile
doc/Makefile doc/manuals/Makefile doc/tutorials/Makefile
doc/programs/Makefile doc/programs/html/Makefile doc/programs/text/Makefile
jemboss/Makefile jemboss/api/Makefile jemboss/api/org/Makefile
jemboss/api/org/emboss/Makefile jemboss/api/org/emboss/jemboss/Makefile
jemboss/api/org/emboss/jemboss/gui/Makefile
jemboss/api/org/emboss/jemboss/gui/filetree/Makefile
jemboss/api/org/emboss/jemboss/gui/form/Makefile
jemboss/api/org/emboss/jemboss/gui/sequenceChooser/Makefile
jemboss/api/org/emboss/jemboss/gui/startup/Makefile
jemboss/api/org/emboss/jemboss/parser/Makefile
jemboss/api/org/emboss/jemboss/parser/acd/Makefile
jemboss/api/org/emboss/jemboss/programs/Makefile
jemboss/api/org/emboss/jemboss/soap/Makefile
jemboss/images/Makefile
jemboss/lib/Makefile jemboss/org/Makefile jemboss/org/emboss/Makefile
jemboss/org/emboss/jemboss/Makefile jemboss/org/emboss/jemboss/gui/Makefile
jemboss/org/emboss/jemboss/gui/filetree/Makefile
jemboss/org/emboss/jemboss/gui/form/Makefile
jemboss/org/emboss/jemboss/gui/startup/Makefile
jemboss/org/emboss/jemboss/gui/sequenceChooser/Makefile
jemboss/org/emboss/jemboss/parser/Makefile
jemboss/org/emboss/jemboss/parser/acd/Makefile
jemboss/org/emboss/jemboss/programs/Makefile
jemboss/org/emboss/jemboss/server/Makefile
jemboss/org/emboss/jemboss/soap/Makefile
jemboss/resources/Makefile jemboss/utils/Makefile
Makefile)
