<!--START OF HEADER - DON'T ALTER -->

<HTML>
<HEAD>
  <TITLE>
  EMBOSS: fclique
  </TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" text="#000000">



<table align=center border=0 cellspacing=0 cellpadding=0>
<tr><td valign=top>
<A HREF="/" ONMOUSEOVER="self.status='Go to the EMBOSS home page';return true"><img border=0 src="emboss_icon.jpg" alt="" width=150 height=48></a>
</td>
<td align=left valign=middle>
<b><font size="+6">

fclique
</font></b>
</td></tr>
</table>
<br>&nbsp;
<p>



<!--END OF HEADER-->






<H2>
    Function
</H2>
Largest clique program

<!--
DON'T WRITE ANYTHING HERE.
IT IS DONE FOR YOU.
-->




<H2>
    Description
</H2>

Finds the largest clique of mutually compatible characters, and the
phylogeny which they recommend, for discrete character data with two
states. The largest clique (or all cliques within a given size range
of the largest one) are found by a very fast branch and bound search
method. The method does not allow for missing data. For such cases the
T (Threshold) option of PARS or MIX may be a useful
alternative. Compatibility methods are particular useful when some
characters are of poor quality and the rest of good quality, but when
it is not known in advance which ones are which.



<H2>
    Algorithm
</H2>

This program uses the compatibility method for unrooted two-state
characters to obtain the largest cliques of characters and the trees
which they suggest. This approach originated in the work of Le Quesne
(1969), though the algorithms were not precisely specified until the
later work of Estabrook, Johnson, and McMorris (1976a, 1976b). These
authors proved the theorem that a group of two-state characters which
were pairwise compatible would be jointly compatible. This program
uses an algorithm inspired by the Kent Fiala - George Estabrook
program CLINCH, though closer in detail to the algorithm of Bron and
Kerbosch (1973). I am indebted to Kent Fiala for pointing out that
paper to me, and to David Penny for decribing to me his
branch-and-bound approach to finding largest cliques, from which I
have also borrowed. I am particularly grateful to Kent Fiala for
catching a bug in versions 2.0 and 2.1 which resulted in those
versions failing to find all of the cliques which they should. The
program computes a compatibility matrix for the characters, then uses
a recursive procedure to examine all possible cliques of characters.

<p>
After one pass through all possible cliques, the program knows the
size of the largest clique, and during a second pass it prints out the
cliques of the right size. It also, along with each clique, prints out
the tree suggested by that clique.

<h3>
  ASSUMPTIONS
</h3>
Basically the following assumptions are made: 

<ol>

<li>Each character evolves independently. 

<li>Different lineages evolve independently. 

<li>The ancestral state is not known. 

<li>Each character has a small chance of being one which evolves so
rapidly, or is so thoroughly misinterpreted, that it provides no
information on the tree.

<li>The probability of a single change in a character (other than in
the high rate characters) is low but not as low as the probability of
being one of these "bad" characters.

<li>The probability of two changes in a low-rate character is much
less than the probability that it is a high-rate character.

<li>The true tree has segments which are not so unequal in length that
two changes in a long are as easy to envisage as one change in a short
segment.  </ol>

<p>
The assumptions of compatibility methods have been treated in several
of my papers (1978b, 1979, 1981b, 1988b), especially the 1981
paper. For an opposing view arguing that the parsimony methods make no
substantive assumptions such as these, see the papers by Farris (1983)
and Sober (1983a, 1983b), but also read the exchange between
Felsenstein and Sober (1986).

<p>
A constant available for alteration at the beginning of the program is
the form width, "FormWide", which you may want to change to make it as
large as possible consistent with the page width available on your
output device, so as to avoid the output of cliques and of trees
getting wrapped around unnecessarily.


<H2>
    Usage
</H2>

<!--  
	Example usage, as run from the command-line.
        Many examples illustrating different behaviours is good.
 -->

<b>Here is a sample session with fclique</b>
<p>

<p>
<table width="90%"><tr><td bgcolor="#CCFFFF"><pre>

% <b>fclique </b>
Largest clique program
Input file: <b>clique.dat</b>
Output file [clique.fclique]: <b></b>


Output written to file "clique.fclique"

Tree written on file "clique.treefile"

Done.


</pre></td></tr></table><p>
<p>
<a href="#input.1">Go to the input files for this example</a><br><a href="#output.1">Go to the output files for this example</a><p><p>




<H2>
    Command line arguments
</H2>

<table CELLSPACING=0 CELLPADDING=3 BGCOLOR="#f5f5ff" ><tr><td>
<pre>
   Standard (Mandatory) qualifiers:
  [-infile]            discretestates (no help text) discretestates value
  [-outfile]           outfile    Output file name

   Additional (Optional) qualifiers (* if not always prompted):
   -ancfile            properties Ancestral states file
   -factorfile         properties Multistate factors file
   -weights            properties Weights file
   -cliqmin            integer    Minimum clique size
   -outgrno            integer    Species number to use as outgroup
   -[no]trout          toggle     Write out trees to tree file
*  -outtreefile        outfile    Tree file name
   -printdata          boolean    Print data at start of run
   -[no]progress       boolean    Print indications of progress of run
   -[no]treeprint      boolean    Print out tree
   -printcomp          boolean    Print out compatibility matrix

   Advanced (Unprompted) qualifiers: (none)
   Associated qualifiers:

   "-outfile" associated qualifiers
   -odirectory2        string     Output directory

   "-outtreefile" associated qualifiers
   -odirectory         string     Output directory

   General qualifiers:
   -auto               boolean    Turn off prompts
   -stdout             boolean    Write standard output
   -filter             boolean    Read standard input, write standard output
   -options            boolean    Prompt for standard and additional values
   -debug              boolean    Write debug output to program.dbg
   -verbose            boolean    Report some/full command line options
   -help               boolean    Report command line options. More
                                  information on associated and general
                                  qualifiers can be found with -help -verbose
   -warning            boolean    Report warnings
   -error              boolean    Report errors
   -fatal              boolean    Report fatal errors
   -die                boolean    Report deaths


</pre>
</td></tr></table>
<P>
<table border cellspacing=0 cellpadding=3 bgcolor="#ccccff">
<tr bgcolor="#FFFFCC">
<th align="left" colspan=2>Standard (Mandatory) qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>[-infile]<br>(Parameter 1)</td>
<td>(no help text) discretestates value</td>
<td>Discrete states file</td>
<td>&nbsp;</td>
</tr>

<tr>
<td>[-outfile]<br>(Parameter 2)</td>
<td>Output file name</td>
<td>Output file</td>
<td><i>&lt;sequence&gt;</i>.fclique</td>
</tr>

<tr bgcolor="#FFFFCC">
<th align="left" colspan=2>Additional (Optional) qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>-ancfile</td>
<td>Ancestral states file</td>
<td>Property value(s)</td>
<td>&nbsp;</td>
</tr>

<tr>
<td>-factorfile</td>
<td>Multistate factors file</td>
<td>Property value(s)</td>
<td>&nbsp;</td>
</tr>

<tr>
<td>-weights</td>
<td>Weights file</td>
<td>Property value(s)</td>
<td>&nbsp;</td>
</tr>

<tr>
<td>-cliqmin</td>
<td>Minimum clique size</td>
<td>Integer 0 or more</td>
<td>0</td>
</tr>

<tr>
<td>-outgrno</td>
<td>Species number to use as outgroup</td>
<td>Integer 0 or more</td>
<td>0</td>
</tr>

<tr>
<td>-[no]trout</td>
<td>Write out trees to tree file</td>
<td>Toggle value Yes/No</td>
<td>Yes</td>
</tr>

<tr>
<td>-outtreefile</td>
<td>Tree file name</td>
<td>Output file</td>
<td>&nbsp;</td>
</tr>

<tr>
<td>-printdata</td>
<td>Print data at start of run</td>
<td>Boolean value Yes/No</td>
<td>No</td>
</tr>

<tr>
<td>-[no]progress</td>
<td>Print indications of progress of run</td>
<td>Boolean value Yes/No</td>
<td>Yes</td>
</tr>

<tr>
<td>-[no]treeprint</td>
<td>Print out tree</td>
<td>Boolean value Yes/No</td>
<td>Yes</td>
</tr>

<tr>
<td>-printcomp</td>
<td>Print out compatibility matrix</td>
<td>Boolean value Yes/No</td>
<td>No</td>
</tr>

<tr bgcolor="#FFFFCC">
<th align="left" colspan=2>Advanced (Unprompted) qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td colspan=4>(none)</td>
</tr>

</table>


<!--
DON'T WRITE ANYTHING HERE.
IT IS DONE FOR YOU.
-->








<H2>
    Input file format
</H2>

Input to the algorithm is standard, but the "?", "P", and "B" states
are not allowed. This is a serious limitation of this program. If you
want to find large cliques in data that has "?" states, I recommend
that you use <b>fmix</b> instead with the -Threshold option and the value
of the threshold set to 2.0. The theory underlying this is given in my
paper on character weighting (Felsenstein, 1981b).


[an error occurred while processing this directive]
[an error occurred while processing this directive]
[an error occurred while processing this directive]
[an error occurred while processing this directive]
[an error occurred while processing this directive]
<p>

<b>fclique</b> reads discrete character data with 2 states.


<a name="input.1"></a>
<h3>Input files for usage example </h3>
<p><h3>File: clique.dat</h3>
<table width="90%"><tr><td bgcolor="#FFCCFF">
<pre>
     5    6
Alpha     110110
Beta      110000
Gamma     100110
Delta     001001
Epsilon   001110
</pre>
</td></tr></table><p>






<H2>
    Output file format
</H2>

<!-- 
        This includes example output file formats.
        This should be a detailed description and example - assume
        someone will want to parse this file and will want to know what
        happens in unusual cases - null output, errors etc. 

        If you wish to include the standard description of the avalable
	report formats, use:
[an error occurred while processing this directive]
   -->

<b>fclique</b> 
writes the cliques to the text output file and a tree to a separate output file

<p>


<a name="output.1"></a>
<h3>Output files for usage example </h3>
<p><h3>File: clique.fclique</h3>
<table width="90%"><tr><td bgcolor="#CCFFCC">
<pre>

Largest clique program, version 3.6b




Largest Cliques
------- -------


Characters: (  1  2  3  6)


  Tree and characters:

     2  1  3  6
     0  0  1  1

             +1-Delta     
       +0--1-+
  +--0-+     +--Epsilon   
  !    !
  !    +--------Gamma     
  !
  +-------------Alpha     
  !
  +-------------Beta      

remember: this is an unrooted tree!


</pre>
</td></tr></table><p>
<p><h3>File: clique.treefile</h3>
<table width="90%"><tr><td bgcolor="#CCFFCC">
<pre>
(((Delta,Epsilon),Gamma),Alpha,Beta);
</pre>
</td></tr></table><p>



<H2>
    Data files
</H2>

None

<H2>
    Notes
</H2>

<!-- 
        Restrictions.
        Interesting behaviour.
        Useful things you can do with this program.
   -->

None.







<H2>
    References
</H2>

<!-- 
        Bibliography for methods used.
   -->

None.








<H2>
    Warnings
</H2>

<!-- 
        Potentially stupid things the program will let you do.
   -->

None.







<H2>
    Diagnostic Error Messages
</H2>

<!-- 
        Error messages specific to this program, eg:
        "FATAL xxx" - means you have not set up the xxx data using program <b>prog</b>.<p>
   -->

None.







<H2>
    Exit status
</H2>

<!-- 
        Description of the exit status for various error conditions
   -->

It always exits with status 0.








<H2>
    Known bugs
</H2>


<!-- 
        Bugs noted but not yet fixed.
   -->

None.








<!--
<H2>
    See also
</H2>
-->
<h2><a name="See also">See also</a></h2>
<table border cellpadding=4 bgcolor="#FFFFF0">
<tr><th>Program name</th><th>Description</th></tr>
<tr><td><a href="../phylip/eclique.html">eclique</a></td><td>Largest clique program</td></tr>
<tr><td><a href="../phylip/edollop.html">edollop</a></td><td>Dollo and polymorphism parsimony algorithm</td></tr>
<tr><td><a href="../phylip/edolpenny.html">edolpenny</a></td><td>Penny algorithm Dollo or polymorphism</td></tr>
<tr><td><a href="../phylip/efactor.html">efactor</a></td><td>Multistate to binary recoding program</td></tr>
<tr><td><a href="../phylip/emix.html">emix</a></td><td>Mixed parsimony algorithm</td></tr>
<tr><td><a href="../phylip/epenny.html">epenny</a></td><td>Penny algorithm, branch-and-bound to find all most parsimonious trees</td></tr>
<tr><td><a href="fdollop.html">fdollop</a></td><td>Dollo and polymorphism parsimony algorithm</td></tr>
<tr><td><a href="fdolpenny.html">fdolpenny</a></td><td>Penny algorithm Dollo or polymorphism</td></tr>
<tr><td><a href="ffactor.html">ffactor</a></td><td>Multistate to binary recoding program</td></tr>
<tr><td><a href="fmix.html">fmix</a></td><td>Mixed parsimony algorithm</td></tr>
<tr><td><a href="fmove.html">fmove</a></td><td>Interactive mixed method parsimony</td></tr>
<tr><td><a href="fpars.html">fpars</a></td><td>Discrete character parsimony</td></tr>
<tr><td><a href="fpenny.html">fpenny</a></td><td>Penny algorithm, branch-and-bound to find all most parsimonious trees</td></tr>
</table>

<!-- 
        Add any comments about other associated programs (to prepare
        data files?) that seealso doesn't find. 
   -->










<H2>
    Author(s)
</H2>

This program is an EMBOSS conversion of a program written by Joe
Felsenstein as part of his PHYLIP package.

<p>
Although we take every care to ensure that the results of the EMBOSS
version are identical to those from the original package, we recommend
that you check your inputs give the same results in both versions
before publication.

<p>
Please report all bugs in the EMBOSS version to the EMBOSS bug team,
not to the original author.



<H2>
    History
</H2>

Written (2004) - Joe Felsenstein, University of Washington.
<p>
Converted (August 2004) to an EMBASSY program by the EMBOSS team.




<H2>
    Target users
</H2>

<!--
        For general users, requested by one user, for EMBOSS site
        maintainers, for EMBOSS developers etc.
        eg:
        "This program is intended to be used by everyone and everything,
        from naive users to embedded scripts." 
	Which is easy to include using:
   -->

This program is intended to be used by everyone and everything, from naive users to embedded scripts.












</BODY>
</HTML>

