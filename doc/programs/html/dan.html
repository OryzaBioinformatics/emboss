<HTML>

<HEAD>
  <TITLE>
  EMBOSS: dan
  </TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" text="#000000">



<table align=center border=0 cellspacing=0 cellpadding=0>
<tr><td valign=top>
<A HREF="index.html" ONMOUSEOVER="self.status='Go to the EMBOSS home page';return true"><img border=0 src="emboss_icon.jpg" alt="" width=150 height=48></a>
</td>
<td align=left valign=middle>
<b><font size="+6">

dan
</font></b>
</td></tr>
</table>
<br>&nbsp;
<p>



<H2>
    Function
</H2>



<!--
DON'T WRITE ANYTHING HERE.
IT IS DONE FOR YOU.
-->
Calculates DNA RNA/DNA melting temperature


<H2>
    Description
</H2>


Dan calculates the melting temperature (Tm) and the percent G+C of a
nucleic acid sequence (optionally plotting them).  For the Melting
temperature profile, free energy values calculated from nearest neighbor
thermodynamics are used (Breslauer et al.  Proc.  Natl.  Acad.  Sci. 
USA 83, 3746-3750 and Baldino et al.  Methods in Enzymol.  168,
761-777). 

<H2>
    Usage
</H2>


Here is a sample session with dan.

<pre>

% dan
Input sequence: embl:paamir
Enter window size [20]: 
Enter Shift Increment [1]: 
Enter DNA concentration (nM) [50.]: 
Enter salt concentration (mM) [50.]: 
Output file [paamir.dan]: 

</pre>

An example of producing a plot of Tm:

<pre>

% dan -plot
Input sequence(s): embl:paamir
Enter window size [20]: 
Enter Shift Increment [1]: 
Enter DNA concentration (nM) [50.]: 
Enter salt concentration (mM) [50.]: 
Enter minimum temperature [55.]: 
Graph type [x11]: 

</pre>



<H2>
    Command line arguments
</H2>



<!--
DON'T WRITE ANYTHING HERE.
IT IS DONE FOR YOU.
-->

<table CELLSPACING=0 CELLPADDING=3 BGCOLOR="#f5f5ff" ><tr><td>
<pre>
   Mandatory qualifiers (* if not always prompted):
  [-sequence]          seqall     Sequence database USA
   -windowsize         integer    The values of melting point and other
                                  thermodynamic properties of the sequence are
                                  determined by taking a short length of
                                  sequence known as a window and determining
                                  the properties of the sequence in that
                                  window. The window is incrementally moved
                                  along the sequence with the properties being
                                  calculated at each new position.
   -shiftincrement     integer    This is the amount by which the window is
                                  moved at each increment in order to find the
                                  melting point and other properties along
                                  the sequence.
   -dnaconc            float      Enter DNA concentration (nM)
   -saltconc           float      Enter salt concentration (mM)
*  -formamide          float      This specifies the percent formamide to be
                                  used in calculations (it is ignored unless
                                  -product is used).
*  -mismatch           float      This specifies the percent mismatch to be
                                  used in calculations (it is ignored unless
                                  -product is used).
*  -prodlen            integer    This specifies the product length to be used
                                  in calculations (it is ignored unless
                                  -product is used).
*  -mintemp            float      Enter a minimum value for the temperature
                                  scale (y-axis) of the plot.
*  -graph              xygraph    Graph type
*  -outfile            report     If a plot is not being produced then data on
                                  the melting point etc. in each window along
                                  the sequence is output to the file.

   Optional qualifiers (* if not always prompted):
*  -temperature        float      If -thermo has been specified then this
                                  specifies the temperature at which to
                                  calculate the DeltaG, DeltaH and DeltaS
                                  values.

   Advanced qualifiers:
   -rna                boolean    This specifies that the sequence is an RNA
                                  sequnce and not a DNA sequence.
   -product            boolean    This prompts for percent formamide, percent
                                  of mismatches allowed and product length.
   -thermo             boolean    Output the DeltaG, DeltaH and DeltaS values
                                  of the sequence windows to the output data
                                  file.
   -plot               boolean    If this is not specified then the file of
                                  output data is produced, else a plot of the
                                  melting point along the sequence is
                                  produced.

   General qualifiers:
  -help                boolean    Report command line options. More
                                  information on associated and general
                                  qualifiers can be found with -help -verbose


</pre>
</td></tr></table>
<P>

<table border cellspacing=0 cellpadding=3 bgcolor="#f5f5ff">
<tr bgcolor="#FFFFD0">
<th align="left" colspan=2>Mandatory qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>[-sequence]<br>(Parameter 1)</td>
<td>Sequence database USA</td>
<td>Readable sequence(s)</td>
<td><b>Required</b></td>
</tr>

<tr>
<td>-windowsize</td>
<td>The values of melting point and other thermodynamic properties of the sequence are determined by taking a short length of sequence known as a window and determining the properties of the sequence in that window. The window is incrementally moved along the sequence with the properties being calculated at each new position.</td>
<td>Integer from 1 to 100</td>
<td>20</td>
</tr>

<tr>
<td>-shiftincrement</td>
<td>This is the amount by which the window is moved at each increment in order to find the melting point and other properties along the sequence.</td>
<td>Integer 1 or more</td>
<td>1</td>
</tr>

<tr>
<td>-dnaconc</td>
<td>Enter DNA concentration (nM)</td>
<td>Number from 1.000 to 100000.000</td>
<td>50.</td>
</tr>

<tr>
<td>-saltconc</td>
<td>Enter salt concentration (mM)</td>
<td>Number from 1.000 to 1000.000</td>
<td>50.</td>
</tr>

<tr>
<td>-formamide</td>
<td>This specifies the percent formamide to be used in calculations (it is ignored unless -product is used).</td>
<td>Number from 0.000 to 100.000</td>
<td>0.</td>
</tr>

<tr>
<td>-mismatch</td>
<td>This specifies the percent mismatch to be used in calculations (it is ignored unless -product is used).</td>
<td>Number from 0.000 to 100.000</td>
<td>0.</td>
</tr>

<tr>
<td>-prodlen</td>
<td>This specifies the product length to be used in calculations (it is ignored unless -product is used).</td>
<td>Any integer value</td>
<td>Window size (20)</td>
</tr>

<tr>
<td>-mintemp</td>
<td>Enter a minimum value for the temperature scale (y-axis) of the plot.</td>
<td>Number from 0.000 to 150.000</td>
<td>55.</td>
</tr>

<tr>
<td>-graph</td>
<td>Graph type</td>
<td>EMBOSS has a list of known devices, including postscript, ps, hpgl, hp7470, hp7580, meta, colourps, cps, xwindows, x11, tektronics, tekt, tek4107t, tek, none, null, text, data, xterm, png</td>
<td><i>EMBOSS_GRAPHICS</i> value, or x11</td>
</tr>

<tr>
<td>-outfile</td>
<td>If a plot is not being produced then data on the melting point etc. in each window along the sequence is output to the file.</td>
<td>Report file</td>
<td>&nbsp;</td>
</tr>

<tr bgcolor="#FFFFD0">
<th align="left" colspan=2>Optional qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>-temperature</td>
<td>If -thermo has been specified then this specifies the temperature at which to calculate the DeltaG, DeltaH and DeltaS values.</td>
<td>Number from 0.000 to 100.000</td>
<td>25.</td>
</tr>

<tr bgcolor="#FFFFD0">
<th align="left" colspan=2>Advanced qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>-rna</td>
<td>This specifies that the sequence is an RNA sequnce and not a DNA sequence.</td>
<td>Yes/No</td>
<td>No</td>
</tr>

<tr>
<td>-product</td>
<td>This prompts for percent formamide, percent of mismatches allowed and product length.</td>
<td>Yes/No</td>
<td>No</td>
</tr>

<tr>
<td>-thermo</td>
<td>Output the DeltaG, DeltaH and DeltaS values of the sequence windows to the output data file.</td>
<td>Yes/No</td>
<td>No</td>
</tr>

<tr>
<td>-plot</td>
<td>If this is not specified then the file of output data is produced, else a plot of the melting point along the sequence is produced.</td>
<td>Yes/No</td>
<td>No</td>
</tr>

</table>



<H2>
    Input file format
</H2>


Any DNA or RNA sequence USA. 

<H2>
    Output file format
</H2>


If a plot is not being produced, dan reports the sequence of each
oligomer window, its melting temperature under the specified conditions
and its GC content. 

<p>

<p>

The output is a standard EMBOSS report file. 

<p>

The results can be output in one of several styles by using the
command-line qualifier <b>-rformat xxx</b>, where 'xxx' is replaced by
the name of the required format.  The available format names are: embl,
genbank, gff, pir, swiss, trace, listfile, dbmotif, diffseq, excel,
feattable, motif, regions, seqtable, simple, srs, table, tagseq

<p>

See:
<A href="http://www.uk.embnet.org/Software/EMBOSS/Themes/ReportFormats.html">
http://www.uk.embnet.org/Software/EMBOSS/Themes/ReportFormats.html</A>
for further information on report formats.

<p>


<p>

By default <b>dan</b> writes a 'seqtable' report file.


<p>

This is the start and the end of the output file from the example. 

<pre>

########################################
# Program: dan
# Rundate: Mon Feb 11 12:07:10 2002
# Report_file: paamir.dan
########################################

#=======================================
#
# Sequence: PAAMIR     from: 1   to: 2167
# HitCount: 2148
#=======================================

  Start     End Tm     GC     DeltaG DeltaH DeltaS TmProd Sequence
      1      20 64.9   70.0   .      .      .      .      ggtaccgctggccgagcatc
      2      21 63.7   65.0   .      .      .      .      gtaccgctggccgagcatct
      3      22 63.7   65.0   .      .      .      .      taccgctggccgagcatctg
      4      23 66.9   70.0   .      .      .      .      accgctggccgagcatctgc
      5      24 66.7   70.0   .      .      .      .      ccgctggccgagcatctgct
      6      25 65.5   70.0   .      .      .      .      cgctggccgagcatctgctc
      7      26 65.5   70.0   .      .      .      .      gctggccgagcatctgctcg
      8      27 63.7   65.0   .      .      .      .      ctggccgagcatctgctcga
      9      28 62.9   60.0   .      .      .      .      tggccgagcatctgctcgat
     10      29 62.6   65.0   .      .      .      .      ggccgagcatctgctcgatc
     11      30 61.7   60.0   .      .      .      .      gccgagcatctgctcgatca
     12      31 60.2   60.0   .      .      .      .      ccgagcatctgctcgatcac
etc.

   2143    2162 65.6   70.0   .      .      .      .      ggtggccgccaaccagttcc
   2144    2163 64.4   65.0   .      .      .      .      gtggccgccaaccagttcct
   2145    2164 64.1   65.0   .      .      .      .      tggccgccaaccagttcctc
   2146    2165 65.4   70.0   .      .      .      .      ggccgccaaccagttcctcg
   2147    2166 64.2   65.0   .      .      .      .      gccgccaaccagttcctcga
   2148    2167 62.4   65.0   .      .      .      .      ccgccaaccagttcctcgag

#---------------------------------------
#---------------------------------------     

</pre>

<p>
The header information contains details of the program, date and sequence

<p>
Subsequent lines contain columns of data for each window into the
sequence as it is moved along, giving:

<p>
<ul>
<li> The start postion of the window
<li> The end position of the window
<li> The melting temperature of the window
<li> The percentage C+G of the window
<li> The sequence of the window
</ul>

<p>
If the qualifier '-product' is used to make the program prompt for
percent formamide percent of mismatches allowed and product length, then
the output includes the melting temperature of the specified product:

<pre>

########################################
# Program: dan
# Rundate: Mon Feb 11 12:11:25 2002
# Report_file: paamir.dan
########################################

#=======================================
#
# Sequence: PAAMIR     from: 1   to: 2167
# HitCount: 2148
#=======================================

  Start     End Tm     GC     DeltaG DeltaH DeltaS TmProd Sequence
      1      20 64.9   70.0   .      .      .      54.9   ggtaccgctggccgagcatc
      2      21 63.7   65.0   .      .      .      52.8   gtaccgctggccgagcatct
      3      22 63.7   65.0   .      .      .      52.8   taccgctggccgagcatctg
      4      23 66.9   70.0   .      .      .      54.9   accgctggccgagcatctgc

etc.
</pre>


<p>
If the qualifier '-thermo' is gived then the DeltaG, DeltaH and DeltaS
of the sequence in the window is also output. 

<H2>
    Data files
</H2>


The EMBOSS data files "Edna.melt" and "Erna.melt" are used to read in the
entropy/enthalpy/energy data for DNA and RNA respectively. 

<p>
EMBOSS data files are distributed with the application and stored
in the standard EMBOSS data directory, which is defined
by EMBOSS environment variable EMBOSS_DATA.

<p>

Users can provide their own data files in their own directories.
Project specific files can be put in the current directory, or for
tidier directory listings in a subdirectory called
".embossdata". Files for all EMBOSS runs can be put in the user's home
directory, or again in a subdirectory called ".embossdata".

<p>
The directories are searched in the following order:

<ul>
   <li> . (your current directory)
   <li> .embossdata (under your current directory)
   <li> ~/ (your home directory)
   <li> ~/.embossdata
</ul>

<H2>
    Notes
</H2>

None.


<H2>
    References
</H2>


<ol>

<li>
Breslauer, K.J., Frank, R., Blocker, H., and Marky, L.A.  (1986). 
"Predicting DNA Duplex Stability from the Base Sequence." Proceedings of
the National Academy of Sciences USA 83, 3746-3750. 

<li>
Baldino, M., Jr.  (1989).  "High Resolution In Situ Hybridization
Histochemistry." In Methods in Enzymology, (P.M.  Conn, ed.), 168,
761-777, Academic Press, San Diego, California, USA. 

</ol>

<H2>
    Warnings
</H2>


RNA sequences must be submited to this application with the '-rna'
qualifier on the command line, otherwise the sequence will be assumed to
be DNA. 

<H2>
    Diagnostic Error Messages
</H2>

None.

<H2>
    Exit status
</H2>


0 if successful. 

<H2>
    Known bugs
</H2>

None.

<!--
<H2>
    See also
</H2>
-->
<h2><a name="See also">See also</a></h2>
<table border cellpadding=4 bgcolor="#FFFFF0">
<tr><th>Program name</th><th>Description</th></tr>
<tr><td><a href="banana.html">banana</a></td><td>Bending and curvature plot in B-DNA</td></tr>
<tr><td><a href="btwisted.html">btwisted</a></td><td>Calculates the twisting in a B-DNA sequence</td></tr>
<tr><td><a href="chaos.html">chaos</a></td><td>Create a chaos game representation plot for a sequence</td></tr>
<tr><td><a href="compseq.html">compseq</a></td><td>Counts the composition of dimer/trimer/etc words in a sequence</td></tr>
<tr><td><a href="freak.html">freak</a></td><td>Residue/base frequency table or plot</td></tr>
<tr><td><a href="isochore.html">isochore</a></td><td>Plots isochores in large DNA sequences</td></tr>
<tr><td><a href="wordcount.html">wordcount</a></td><td>Counts words of a specified size in a DNA sequence</td></tr>
</table>

<!--
        Add any comments about other associated programs (to prepare
        data files?) that seealso doesn't find.
   -->


<H2>
    Author(s)
</H2>


This program was originally included in EGCG under the names "MELT"
and "MELTPLOT", written by Rodrigo Lopez.

<p>
This application was written by Alan Bleasby <a
href="mailto:ableasby@hgmp.mrc.ac.uk">(ableasby@hgmp.mrc.ac.uk)</a>

<H2>
    History
</H2>

Written (1999) - Alan Bleasby

<H2>
    Target users
</H2>


This program is intended to be used by everyone and everything,
from naive users to embedded scripts. 

<H2>
    Comments
</H2>


<pre>

</pre>


</BODY>
</HTML>

