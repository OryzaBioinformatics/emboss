<!--
Edit this file to replace 'diffseq' with the name of the program.
-->

<HTML>

<HEAD>
  <TITLE>
  EMBOSS
  </TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" text="#000000">

<table align=center bgcolor="#000070" border=0 cellspacing=0 cellpadding=10>
<tr>
<td>

<a href="index.html" onmouseover="self.status='Go to the EMBOSS home page';return true">
<img border=0 src="emboss_icon.gif" alt="" width=55 height=55>
</a>

</td>

<td align=middle valign=middle>
<font face="Arial,Helvetica" size=6 color="#ffffff">
<H2>
EMBOSS: diffseq
</H2>
</font>
</td>

</tr>
</table>
</td>

</tr>
</table>

<p><hr><p>

<!--END OF HEADER-->





<H1>
Program diffseq
</H1>
<H2>
    Function
</H2>

<!--
DON'T WRITE ANYTHING HERE.
IT IS DONE FOR YOU.
-->
Find differences (SNPs) between nearly identical sequences


<H2>
    Description
</H2>

<!-- 
	This is the main part of the document.

        This is what the user looks at to find out if this program will
        do what he wants. 

        Long description.

        Why it is useful.

        When it should/shouldn't be used.

        Algorithms

        Expanded description.

        eg: Reverse engineers Wheedle's 'talpsgob' program. This does a 
        splurge of the 5' end of the sequence followed by a durm.
        The net effect is a 5' end splurt.
        etc. for as long as is required (several pages is not unreasonable)
  -->

   <b>diffseq</b> takes two overlapping, nearly identical sequences and reports the
   differences between them, together with any features that overlap with these
   regions. GFF files of the differences in each sequence are also produced.
<p>
   <b>diffseq</b> should be of value when looking for SNPs, differences between
   strains of an organism and anything else that requires the differences between
   sequences to be highlighted.
<p>  
   The sequences can be very long. The program does a match of all
   sequence words of size 10 (by default). It then reduces this to the
   minimum set of overlapping matches by sorting the matches in order of
   size (largest size first) and then for each such match it removes any
   smaller matches that overlap. The result is a set of the longest
   ungapped alignments between the two sequences that do not overlap with
   each other. The mismatched regions between these matches are reported.
<p>   
   It should be possible to find differences between sequences that are Mega bytes
   long.
<p>
     



<H2>
    Usage
</H2>

<!--  
	Example usage, as run from the command-line.
        Many examples illustrating different behaviours is good.
 -->


Here is a sample session with diffseq:

<pre>

% diffseq embl:ap000504 embl:af129756
Find differences (SNPs) between nearly identical sequences
Word size [10]: 
Output file [ap000504.diffseq]:

</pre>


<H2>
    Command line arguments
</H2>

<!--
DON'T WRITE ANYTHING HERE.
IT IS DONE FOR YOU.
-->

<table CELLSPACING=0 CELLPADDING=3 BGCOLOR="#f5f5ff" ><tr><td>
<pre>
   Mandatory qualifiers:
  [-asequence]         sequence   Sequence USA
  [-bsequence]         sequence   Sequence USA
   -wordsize           integer    Word size
   -outfile            outfile    Output report file

   Optional qualifiers:
   -afeatout           featout    File for output of first sequence's normal
                                  tab delimited gff's
   -bfeatout           featout    File for output of second sequence's normal
                                  tab delimited gff's
   -columns            bool       The default format for the output report
                                  file is to have several lines per difference
                                  giving the sequence positions, sequences
                                  and features.
                                  If this option is set true then the output
                                  report file's format is changed to a set of
                                  columns and no feature information is given.

   Advanced qualifiers: (none)

</pre>
</td></tr></table>
<P>

<table border cellspacing=0 cellpadding=3 bgcolor="#f5f5ff">
<tr bgcolor="#FFFFD0">
<th align="left" colspan=2>Mandatory qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>[-asequence]<br>(Parameter 1)</td>
<td>Sequence USA</td>
<td>Readable sequence</td>
<td><b>Required</b></td>
</tr>

<tr>
<td>[-bsequence]<br>(Parameter 2)</td>
<td>Sequence USA</td>
<td>Readable sequence</td>
<td><b>Required</b></td>
</tr>

<tr>
<td>-wordsize</td>
<td>Word size</td>
<td>Integer 2 or more</td>
<td>10</td>
</tr>

<tr>
<td>-outfile</td>
<td>Output report file</td>
<td>Output file</td>
<td><i>&lt;sequence&gt;</i>.diffseq</td>
</tr>

<tr bgcolor="#FFFFD0">
<th align="left" colspan=2>Optional qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>-afeatout</td>
<td>File for output of first sequence's normal tab delimited gff's</td>
<td>Writeable feature table</td>
<td>$(asequence.name).diffgff</td>
</tr>

<tr>
<td>-bfeatout</td>
<td>File for output of second sequence's normal tab delimited gff's</td>
<td>Writeable feature table</td>
<td>$(bsequence.name).diffgff</td>
</tr>

<tr>
<td>-columns</td>
<td>The default format for the output report file is to have several lines per difference giving the sequence positions, sequences and features.
If this option is set true then the output report file's format is changed to a set of columns and no feature information is given.</td>
<td>Yes/No</td>
<td>No</td>
</tr>

<tr bgcolor="#FFFFD0">
<th align="left" colspan=2>Advanced qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td colspan=4>(none)</td>
</tr>

</table>



<H2>
    Input file format
</H2>

<!-- 
        This includes example input file formats.
        Except for sequences which can be described by 'sequence USA',
        this should be a detailed description and example - assume
        someone will want to parse this file and will want to know what
        happens in unusual cases - null input, etc. 
   -->

This program reads in two nucleic acid sequence USAs or two protein sequence USAs.

<H2>
    Output file format
</H2>

<!-- 
        This includes example output file formats 
        Except for sequences which can be described by 'sequence USA',
        this should be a detailed description and example - assume
        someone will want to parse this file and will want to know what
        happens in unusual cases - null output, errors etc. 
   -->

A report of the differences between the two sequences is produced,
together with any features that overlap with these differing regions. 
<p>

An example follows:
<p>
<pre>
<hr>
# Report of diffseq of: AF129756 and AP000504

AF129756 overlap starts at 6036
AP000504 overlap starts at 1


AF129756 6882-6882 Length: 1
Sequence: t
Sequence: a
AP000504 847-847 Length: 1

AF129756 7830-7830 Length: 1
Sequence: a
Sequence: g
AP000504 1795-1795 Length: 1

AF129756 8307 Length: 0
Feature: repeat_region 7920-8351 rpt_family="MSTB"
Sequence: 
Sequence: t
AP000504 2273-2273 Length: 1

AF129756 8500-8500 Length: 1
Feature: repeat_region 8391-8686 rpt_family="AluSg"
Sequence: a
Sequence: g
AP000504 2466-2466 Length: 1

AF129756 8688 Length: 0
Feature: repeat_region 8687-8731 rpt_family="(CA)n"
Sequence: 
Sequence: tgtg
AP000504 2655-2658 Length: 4

AF129756 10945-10962 Length: 18
Feature: repeat_region 10910-10972 rpt_family="(CA)n"
Sequence: gtgtgtgtgtgtgtgtgt
Sequence: 
AP000504 4914 Length: 0

AF129756 10999-11001 Length: 3
Feature: repeat_region 10991-11020 rpt_family="AT_rich"
Sequence: tat
Sequence: aaa
AP000504 4951-4953 Length: 3

AF129756 12647 Length: 0
Feature: repeat_region 12628-12930 rpt_family="AluSq"
Sequence: 
Sequence: t
AP000504 6600-6600 Length: 1

AF129756 12915-12915 Length: 1
Feature: repeat_region 12628-12930 rpt_family="AluSq"
Sequence: a
Sequence: g
AP000504 6868-6868 Length: 1

AF129756 14264 Length: 0
Sequence: 
Sequence: tgtg
AP000504 8218-8221 Length: 4

AF129756 15139-15139 Length: 1
Sequence: a
Sequence: g
AP000504 9096-9096 Length: 1

AF129756 17192-17192 Length: 1
Feature: repeat_region 16933-17231 rpt_family="AluSx"
Sequence: a
Sequence: c
AP000504 11149-11149 Length: 1

[many lines removed for brevity]

AF129756 overlap ends at 106028
AP000504 overlap ends at 100000



No. of SNPs = 86
No. of transitions = 58
No. of transversions = 28
<hr>
</pre>
<p>

The first line is the title giving the names of the sequences used.
<p>
The next two non-blank lines state the positions in each sequence where the detected
overlap between them starts.
<p>
There then follows a set of reports of the mismatches between the sequences.
<br>
Each report consists of 4 or more lines.
<br>
<ul>
<li>The first line has the name of the first sequence followed by the start and end
positions of the mismatched region in that sequence, followed by the length of
the mismatched region. If the mismatched region is of zero length in this sequence,
then only the position of the last matching base before the mismatch is given.</li>

<li>If a feature of the first sequence overlaps with this mismatch region, then one or more
lines starting with 'Feature:' comes next with the type, position and tag field
of the feature.</li>

<li>Next is a line starting "Sequence:" giving the sequence of the mismatch in the
first sequence.</li>
</ul>
<p>

This is followed by the equivalent information for the second sequence,
but in the reverse order, namely 'Sequence:' line, 'Feature:' lines and line
giving the position of the mismatch in the second sequence.
<p>

At the end of the report are two non-blank lines giving the positions in each
sequence where the detected
overlap between them ends.
<p>

The last three lines of the report gives the counts of SNPs (defined as a change of one nucleotide to
one other nucleotide, no deletions or insertions are counted, no multi-base changes are counted).
<p>

The counts of transitions (Pyrimide to Pyrimidine or Purine to Purine) and transversions (Pyrimidine to
Purine) are also given.
<p>

It should be noted that not all features are reported.
<p>

The 'source' feature found in all EMBL/Genbank feature table entries is not reported
as this covers all of the sequence and so overlaps with any difference found in that
sequence and so is uninformative and irritating. It has therefore been removed from
the output report.
<p>

The translation information of CDS features is often extremely long and does not add useful
information to the report. It has therefore been removed from the output report.
<p>

If no regions of alignment are found, the following output is given:
<p>

<pre>
<hr>
# Report of diffseq of: Fred and ECOMPA



No regions of alignment found.
<hr>
</pre>
<p>

If the <b>-columns</b> qualifier is given then the output is given in a columnar format.
<p>

The columns are separated by one or more spaces or TAB characters in the order:
<p>

<ul>
<li>sequence 1 start
<li>sequence 1 end
<li>sequence 1 length
<li>sequence 1 sequence in quotes
<li>sequence 2 start
<li>sequence 2 end
<li>sequence 2 length
<li>sequence 2 sequence in quotes
</ul>
<p>

Note: no features are reported in this format in order to keep the columns lining up nicely.
<p>

For example:
<p>

<pre>
<hr>
# Report of diffseq of: AF129756 and AP000504

# AF129756 overlap starts at 6036
# AP000504 overlap starts at 1

# (AF129756) start end length sequence  (AP000504) start end length sequence

6882    6882    1       't'     847     847     1       'a'
7830    7830    1       'a'     1795    1795    1       'g'
8307    8307    0       ''      2273    2273    1       't'
8500    8500    1       'a'     2466    2466    1       'g'
8688    8688    0       ''      2655    2658    4       'tgtg'
10945   10962   18      'gtgtgtgtgtgtgtgtgt'    4914    4914    0       ''
10999   11001   3       'tat'   4951    4953    3       'aaa'
12647   12647   0       ''      6600    6600    1       't'
12915   12915   1       'a'     6868    6868    1       'g'
14264   14264   0       ''      8218    8221    4       'tgtg'
15139   15139   1       'a'     9096    9096    1       'g'
17192   17192   1       'a'     11149   11149   1       'c'
19761   19761   1       'c'     13718   13718   1       'a'
20291   20291   1       't'     14248   14248   1       'c'
20462   20462   1       'c'     14419   14419   1       'g'
25686   25686   1       'c'     19643   19643   1       't'
26192   26192   1       't'     20149   20149   1       'c'
27227   27227   1       't'     21183   21183   0       ''
27359   27359   0       ''      21316   21319   4       'ctga'
27837   27837   1       't'     21797   21797   1       'c'
29328   29328   1       'a'     23288   23288   1       't'
29458   29458   1       'c'     23418   23418   1       'a'
29629   29629   1       'c'     23589   23589   1       't'
29646   29646   1       'a'     23606   23606   1       'g'
30838   30838   1       't'     24798   24798   1       'c'
31349   31349   1       't'     25309   25309   1       'c'
31901   31901   1       't'     25861   25861   1       'g'
34078   34078   0       ''      28039   28040   2       'ac'
36682   36682   1       't'     30644   30644   1       'c'
38225   38226   2       'gt'    32186   32186   0       ''
38379   38379   1       'g'     32339   32339   1       'c'
38537   38537   1       'c'     32497   32497   1       't'
39114   39114   1       'c'     33074   33074   1       't'
39816   39816   1       'a'     33776   33776   1       'g'
40807   40807   1       'c'     34767   34767   1       'a'
40977   40977   1       'a'     34936   34936   0       ''
41204   41204   1       'g'     35163   35163   1       'a'
42548   42548   1       'a'     36507   36507   1       'g'
43800   43800   0       ''      37760   37762   3       'aaa'
44717   44717   0       ''      38680   38683   4       'aata'
45315   45315   1       'a'     39280   39280   0       ''
48382   48382   1       'g'     42347   42347   1       'a'
48671   48671   0       ''      42637   42638   2       'gt'
50635   50635   1       'c'     44602   44602   1       't'
50809   50809   1       't'     44776   44776   1       'g'
51286   51286   1       'a'     45253   45253   1       'g'
51645   51645   1       't'     45611   45611   0       ''
52388   52388   1       't'     46354   46354   1       'c'
52646   52646   1       'g'     46612   46612   1       'a'
53596   53596   1       'g'     47562   47562   1       'a'
53621   53621   1       'c'     47587   47587   1       't'
54883   54883   1       'a'     48849   48849   1       'g'
55377   55377   1       'a'     49343   49343   1       'g'
55571   55571   1       't'     49537   49537   1       'c'
55611   55611   1       'c'     49577   49577   1       't'
55655   55661   7       'aaaaaaa'       49620   49620   0       ''
56357   56357   1       'g'     50316   50316   1       'a'
58115   58115   1       'c'     52074   52074   1       'a'
59922   59922   1       't'     53881   53881   1       'c'
60092   60092   1       'c'     54051   54051   1       'g'
63114   63114   1       't'     57073   57073   1       'a'
64267   64271   5       'gtttt' 58225   58225   0       ''
64731   64731   1       't'     58685   58685   1       'c'
66604   66604   1       'c'     60558   60558   1       't'
67254   67254   0       ''      61209   61209   1       'c'
69002   69002   0       ''      62958   62959   2       'tt'
69445   69445   1       'a'     63402   63402   1       'g'

[many lines deleted for brevity]

# AF129756 overlap ends at 106028
# AP000504 overlap ends at 100000



# No. of SNPs = 86
# No. of transitions = 58
# No. of transversions = 28
<hr>
</pre>
<p>


If no regions of alignment are found, the following output is given:
<p>

<pre>
<hr>
# Report of diffseq of: Fred and ECOMPA



# No regions of alignment found.
<hr>
</pre>
<p>



<H2>
    Data files
</H2>

<!-- 
        Any data files used (e.g. translation table file)
        This includes example data file formats if they are
        not obvious.

        eg:
        data file format:

	blank lines and comment lines are ignored.
        comment lines start with '#'
        There are three columns separated by one or more space or TAB
	characters for X and Y values of durm, followed by energy
        all coefficients are given as floating point values
        An example is:

        # Durm coefficient enery file
        # X     Y       Energy
        0.1     0.2     0.331
        0.2     0.4     0.332
        0.3     0.6     0.333
        0.3     0.8     0.334



If you wish to include the standard description of what data files
are and how to use embossdata to inspect and retrieve them, use:

<p>
EMBOSS data files are distributed with the application and stored
in the standard EMBOSS data directory, which is defined
by the EMBOSS environment variable EMBOSS_DATA.

<p>

To see the available EMBOSS data files, run:
<p>
<pre>
% embossdata -showall
</pre>
<p>
To fetch one of the data files (for example 'Exxx.dat') into your
current directory for you to inspect or modify, run:

<pre>

% embossdata -fetch -file Exxx.dat

</pre>
<p>

Users can provide their own data files in their own directories.
Project specific files can be put in the current directory, or for
tidier directory listings in a subdirectory called
".embossdata". Files for all EMBOSS runs can be put in the user's home
directory, or again in a subdirectory called ".embossdata".

<p>
The directories are searched in the following order:

<ul>
   <li> . (your current directory)
   <li> .embossdata (under your current directory)
   <li> ~/ (your home directory)
   <li> ~/.embossdata
</ul>
<p>


   -->



<H2>
    Notes
</H2>

<!-- 
        Restrictions.
        Interesting behaviour.
        Useful things you can do with this program.
   -->

It should be noted that not all features are reported.
<p>
The 'source' feature found in all EMBL/Genbank feature table entries is not reported
as this covers all of the sequence and so overlaps with any difference found in that
sequence and so is uninformative and irritating. It has therefore been removed from
the output report.
<p>
The translation information of CDS features is often extremely long and does not add useful
information to the report. It has therefore been removed from the output report.

<p>
If you run out of memory, use a larger word size.
<p>
Using a larger word size increases the length between mismatches that will be
reported as one event. Thus a word size of 50 will report two SNP that are with 50
bases of each other as one mismatch.

   
<H2>
    References
</H2>

<!-- 
        Bibliography for methods used.
   -->

None.

<H2>
    Warnings
</H2>

<!-- 
        Potentially stupid things the program will let you do.
        eg:
        It doesn't check to see if the sequence is a protein sequence or not.
   -->

None.

<H2>
    Diagnostic Error Messages
</H2>

<!-- 
        Error messages specific to this program.
        eg:

        "Threshold value greater than 1." - means that the threshold has
        been set to be greater than 1 but a burgle exception has
        occurred making this invalid - you should reduce the wobble
        parameter and try again. 

   -->
None.

<H2>
    Exit status
</H2>

<!-- 
        Description of the exit status for various error conditions
        eg:
        "0"
   -->
It always exits with status 0.

<H2>
    Known bugs
</H2>


<!-- 
        Bugs noted but not yet fixed.
   -->

None.

<!--
<H2>
    See also
</H2>
-->
<a name=See also><h2>See also</h2></a>
<table border cellpadding=4 bgcolor="#FFFFF0">
<tr><th>Program name</th><th>Description</th></tr>
<tr><td><a href="antigenic.html">antigenic</a></td><td>Finds antigenic sites in proteins</td></tr>
<tr><td><a href="chaos.html">chaos</a></td><td>Create a chaos game representation plot for a sequence</td></tr>
<tr><td><a href="cpgplot.html">cpgplot</a></td><td>Plot CpG rich areas</td></tr>
<tr><td><a href="cpgreport.html">cpgreport</a></td><td>Reports all CpG rich regions</td></tr>
<tr><td><a href="dotmatcher.html">dotmatcher</a></td><td>Displays a thresholded dotplot of two sequences</td></tr>
<tr><td><a href="dotpath.html">dotpath</a></td><td>Displays a non-overlapping wordmatch dotplot of two sequences</td></tr>
<tr><td><a href="dottup.html">dottup</a></td><td>Displays a wordmatch dotplot of two sequences</td></tr>
<tr><td><a href="einverted.html">einverted</a></td><td>Finds DNA inverted repeats</td></tr>
<tr><td><a href="equicktandem.html">equicktandem</a></td><td>Finds tandem repeats</td></tr>
<tr><td><a href="etandem.html">etandem</a></td><td>Looks for tandem repeats in a nucleotide sequence</td></tr>
<tr><td><a href="garnier.html">garnier</a></td><td>Predicts protein secondary structure</td></tr>
<tr><td><a href="helixturnhelix.html">helixturnhelix</a></td><td>Report nucleic acid binding motifs</td></tr>
<tr><td><a href="isochore.html">isochore</a></td><td>Plots isochores in large DNA sequences</td></tr>
<tr><td><a href="marscan.html">marscan</a></td><td>Finds MAR/SAR sites in nucleic sequences</td></tr>
<tr><td><a href="newcpgreport.html">newcpgreport</a></td><td>Report CpG rich areas</td></tr>
<tr><td><a href="newcpgseek.html">newcpgseek</a></td><td>Reports CpG rich regions</td></tr>
<tr><td><a href="oddcomp.html">oddcomp</a></td><td>Finds protein sequence regions with a biased composition</td></tr>
<tr><td><a href="palindrome.html">palindrome</a></td><td>Looks for inverted repeats in a nucleotide sequence</td></tr>
<tr><td><a href="pepcoil.html">pepcoil</a></td><td>Predicts coiled coil regions</td></tr>
<tr><td><a href="polydot.html">polydot</a></td><td>Displays all-against-all dotplots of a set of sequences</td></tr>
<tr><td><a href="primersearch.html">primersearch</a></td><td>Searches DNA sequences for matches with primer pairs</td></tr>
<tr><td><a href="pscan.html">pscan</a></td><td>Scans proteins using PRINTS</td></tr>
<tr><td><a href="recode.html">recode</a></td><td>Remove restriction sites but maintain the same translation</td></tr>
<tr><td><a href="redata.html">redata</a></td><td>Search REBASE for enzyme name, references, suppliers etc</td></tr>
<tr><td><a href="restover.html">restover</a></td><td>Finds restriction enzymes that produce a specific overhang</td></tr>
<tr><td><a href="restrict.html">restrict</a></td><td>Finds restriction enzyme cleavage sites</td></tr>
<tr><td><a href="showseq.html">showseq</a></td><td>Display a sequence with features, translation etc</td></tr>
<tr><td><a href="sigcleave.html">sigcleave</a></td><td>Reports protein signal cleavage sites</td></tr>
<tr><td><a href="silent.html">silent</a></td><td>Silent mutation restriction enzyme scan</td></tr>
<tr><td><a href="tfscan.html">tfscan</a></td><td>Scans DNA sequences for transcription factors</td></tr>
<tr><td><a href="tmap.html">tmap</a></td><td>Displays membrane spanning regions</td></tr>
</table>

<!-- 
        Add any comments about other associated programs (to prepare
        data files?) that seealso doesn't find. 
   -->
<p>
   A graphical dotplot of the matches used in this program can be displayed
   using the program <b>dotpath</b>.



<H2>
    Author(s)
</H2>
<!--
        Who has worked on the program in the past.
e.g.

This application was written by Alan Bleasby <a
href="mailto:ableasby@hgmp.mrc.ac.uk">(ableasby@hgmp.mrc.ac.uk)</a>
   -->

This application was written by Gary Williams <a
href="mailto:gwilliam@hgmp.mrc.ac.uk">(gwilliam@hgmp.mrc.ac.uk)</a>

<H2>
    History
</H2>

<!--
        What changes have been made.
   -->

Written 15th Aug 2000 - Gary Williams.
<br>
18th Aug 2000 - Added writing out GFF files of the mismatched regions

<H2>
    Target users
</H2>

<!--
        For general users, requested by one user, for EMBOSS site
        maintainers, for EMBOSS developers etc.
        eg:
        "This program is intended to be used by everyone and everything,
        from naive users to embedded scripts." 
	Which is easy to include using:

   -->
This program is intended to be used by everyone and everything, from naive users to embedded scripts.



<H2>
    Comments
</H2>

<!--
	Any comments, requests etc. that people have about the program
   -->



</TD></TR></TABLE>
</CENTER>

</BODY>
</HTML>

