<!--START OF HEADER - DON'T ALTER -->

<HTML>
<HEAD>
  <TITLE>
  EMBOSS: ffactor
  </TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" text="#000000">



<table align=center border=0 cellspacing=0 cellpadding=0>
<tr><td valign=top>
<A HREF="/" ONMOUSEOVER="self.status='Go to the EMBOSS home page';return true"><img border=0 src="emboss_icon.jpg" alt="" width=150 height=48></a>
</td>
<td align=left valign=middle>
<b><font size="+6">

ffactor
</font></b>
</td></tr>
</table>
<br>&nbsp;
<p>



<!--END OF HEADER-->






<H2>
    Function
</H2>
Multistate to binary recoding program

<!--
DON'T WRITE ANYTHING HERE.
IT IS DONE FOR YOU.
-->




<H2>
    Description
</H2>

Takes discrete multistate data with character state trees and produces
the corresponding data set with two states (0 and 1). Written by
Christopher Meacham. This program was formerly used to accomodate
multistate characters in MIX, but this is less necessary now that PARS
is available.



<H2>
    Algorithm
</H2>


This program factors a data set that contains multistate characters,
creating a data set consisting entirely of binary (0,1) characters
that, in turn, can be used as input to any of the other discrete
character programs in this package, except for PARS. Besides this
primary function, FACTOR also provides an easy way of deleting
characters from a data set. The input format for FACTOR is very
similar to the input format for the other discrete character programs
except for the addition of character-state tree descriptions.

<p>
Note that this program has no way of converting an unordered
multistate character into binary characters. Fortunately, PARS has
joined the package, and it enables unordered multistate characters, in
which any state can change to any other in one step, to be analyzed
with parsimony.

<p>
FACTOR is really for a different case, that in which there are
multiple states related on a "character state tree", which specifies
for each state which other states it can change to. That graph of
states is assumed to be a tree, with no loops in it.


<H2>
    Usage
</H2>

<!--  
	Example usage, as run from the command-line.
        Many examples illustrating different behaviours is good.
 -->

<b>Here is a sample session with ffactor</b>
<p>

<p>
<table width="90%"><tr><td bgcolor="#CCFFFF"><pre>

% <b>ffactor </b>
Multistate to binary recoding program
File containing data set: <b>factor.dat</b>
Output file [factor.ffactor]: <b></b>


Data matrix written on file "factor.ffactor"

Done.


</pre></td></tr></table><p>
<p>
<a href="#input.1">Go to the input files for this example</a><br><a href="#output.1">Go to the output files for this example</a><p><p>




<H2>
    Command line arguments
</H2>

<table CELLSPACING=0 CELLPADDING=3 BGCOLOR="#f5f5ff" ><tr><td>
<pre>
   Standard (Mandatory) qualifiers:
  [-infile]            infile     File containing data set
  [-outfile]           outfile    Output file name

   Additional (Optional) qualifiers:
   -anc                boolean    Put ancestral states in output file
   -factors            boolean    Put factors information in output file
   -[no]progress       boolean    Print indications of progress of run

   Advanced (Unprompted) qualifiers:
   -outfactorfile      outfile    Factor outfile name
   -outancfile         outfile    Ancestor outfile name

   Associated qualifiers:

   "-outfile" associated qualifiers
   -odirectory2        string     Output directory

   "-outfactorfile" associated qualifiers
   -odirectory         string     Output directory

   "-outancfile" associated qualifiers
   -odirectory         string     Output directory

   General qualifiers:
   -auto               boolean    Turn off prompts
   -stdout             boolean    Write standard output
   -filter             boolean    Read standard input, write standard output
   -options            boolean    Prompt for standard and additional values
   -debug              boolean    Write debug output to program.dbg
   -verbose            boolean    Report some/full command line options
   -help               boolean    Report command line options. More
                                  information on associated and general
                                  qualifiers can be found with -help -verbose
   -warning            boolean    Report warnings
   -error              boolean    Report errors
   -fatal              boolean    Report fatal errors
   -die                boolean    Report deaths


</pre>
</td></tr></table>
<P>
<table border cellspacing=0 cellpadding=3 bgcolor="#ccccff">
<tr bgcolor="#FFFFCC">
<th align="left" colspan=2>Standard (Mandatory) qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>[-infile]<br>(Parameter 1)</td>
<td>File containing data set</td>
<td>Input file</td>
<td><b>Required</b></td>
</tr>

<tr>
<td>[-outfile]<br>(Parameter 2)</td>
<td>Output file name</td>
<td>Output file</td>
<td><i>&lt;sequence&gt;</i>.ffactor</td>
</tr>

<tr bgcolor="#FFFFCC">
<th align="left" colspan=2>Additional (Optional) qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>-anc</td>
<td>Put ancestral states in output file</td>
<td>Boolean value Yes/No</td>
<td>No</td>
</tr>

<tr>
<td>-factors</td>
<td>Put factors information in output file</td>
<td>Boolean value Yes/No</td>
<td>No</td>
</tr>

<tr>
<td>-[no]progress</td>
<td>Print indications of progress of run</td>
<td>Boolean value Yes/No</td>
<td>Yes</td>
</tr>

<tr bgcolor="#FFFFCC">
<th align="left" colspan=2>Advanced (Unprompted) qualifiers</th>
<th align="left">Allowed values</th>
<th align="left">Default</th>
</tr>

<tr>
<td>-outfactorfile</td>
<td>Factor outfile name</td>
<td>Output file</td>
<td>&nbsp;</td>
</tr>

<tr>
<td>-outancfile</td>
<td>Ancestor outfile name</td>
<td>Output file</td>
<td>&nbsp;</td>
</tr>

</table>


<!--
DON'T WRITE ANYTHING HERE.
IT IS DONE FOR YOU.
-->








<H2>
    Input file format
</H2>

<!-- 
        This includes example input file formats.
        This should be a detailed description and example - assume
        someone will want to parse this file and will want to know what
        happens in unusual cases - null input, etc. 
   -->

<b>ffactor</b> reads character state tree data.


<p>
This program factors a data set that contains multistate characters,
creating a data set consisting entirely of binary (0,1) characters
that, in turn, can be used as input to any of the other discrete
character programs in this package, except for PARS. Besides this
primary function, FACTOR also provides an easy way of deleting
characters from a data set. The input format for FACTOR is very
similar to the input format for the other discrete character programs
except for the addition of character-state tree descriptions.

<p>
Note that this program has no way of converting an unordered
multistate character into binary characters. Fortunately, PARS has
joined the package, and it enables unordered multistate characters, in
which any state can change to any other in one step, to be analyzed
with parsimony.

<p>
FACTOR is really for a different case, that in which there are
multiple states related on a "character state tree", which specifies
for each state which other states it can change to. That graph of
states is assumed to be a tree, with no loops in it.

<h3>First line</h3>
<p>
The first line of the input file should contain the number of species
and the number of multistate characters. This first line is followed
by the lines describing the character-state trees, one description per
line. The species information constitutes the last part of the
file. Any number of lines may be used for a single species.


<p>
The first line is free format with the number of species first,
separated by at least one blank (space) from the number of multistate
characters, which in turn is separated by at least one blank from the
options, if present.

<h3>Character-state tree descriptions</h3>

<p>
The character-state trees are described in free format. The character
number of the multistate character is given first followed by the
description of the tree itself. Each description must be completed on
a single line. Each character that is to be factored must have a
description, and the characters must be described in the order that
they occur in the input, that is, in numerical order.

<p>
The tree is described by listing the pairs of character states that
are adjacent to each other in the character-state tree. The two
character states in each adjacent pair are separated by a colon
(":"). If character fifteen has this character state tree for possible
states "A", "B", "C", and "D":

<p>
<pre>
                         A ---- B ---- C
                                |
                                |
                                |
                                D
</pre>
<p>
then the character-state tree description would be 

<p>
<pre>
                        15  A:B B:C D:B
</pre>
<p>
Note that either symbol may appear first. The ancestral state is
identified, if desired, by putting it "adjacent" to a period. If we
wanted to root character fifteen at state C:

<p>
<pre>
                         A <--- B <--- C
                                |
                                |
                                V
                                D
</pre>
<p>
we could write 

<p>
<pre>
                      15  B:D A:B C:B .:C
</pre>
<p>
Both the order in which the pairs are listed and the order of the
symbols in each pair are arbitrary. However, each pair may only appear
once in the list. Any symbols may be used for a character state in the
input except the character that signals the connection between two
states (in the distribution copy this is set to ":"), ".", and, of
course, a blank. Blanks are ignored completely in the tree description
so that even B:DA:BC:B.:C or B : DA : BC : B. : C would be equivalent
to the above example. However, at least one blank must separate the
character number from the tree description.


<h3>Deleting characters from a data set</h3>
<p>
If no description line appears in the input for a particular
character, then that character will be omitted from the output. If the
character number is given on the line, but no character-state tree is
provided, then the symbol for the character in the input will be
copied directly to the output without change. This is useful for
characters that are already coded "0" and "1". Characters can be
deleted from a data set simply by listing only those that are to
appear in the output.


<h3>Terminating the list of tree descriptions</h3>

The last character-state tree description should be followed by a line
containing the number "999". This terminates processing of the trees
and indicates the beginning of the species information.


<h3>Species information</h3>

<p>
The format for the species information is basically identical to the
other discrete character programs. The first ten character positions
are allotted to the species name (this value may be changed by
altering the value of the constant nmlngth at the beginning of the
program). The character states follow and may be continued to as many
lines as desired. There is no current method for indicating
polymorphisms. It is possible to either put blanks between characters
or not.

<p>
There is a method for indicating uncertainty about states. There is
one character value that stands for "unknown". If this appears in the
input data then "?" is written out in all the corresponding positions
in the output file. The character value that designates "unknown" is
given in the constant unkchar at the beginning of the program, and can
be changed by changing that constant. It is set to "?" in the
distribution copy.


<p>


<a name="input.1"></a>
<h3>Input files for usage example </h3>
<p><h3>File: factor.dat</h3>
<table width="90%"><tr><td bgcolor="#FFCCFF">
<pre>
   4   6
1 A:B B:C
2 A:B B:.
4
5 0:1 1:2 .:0
6 .:# #:$ #:%
999
Alpha     CAW00#
Beta      BBX01%
Gamma     ABY12#
Epsilon   CAZ01$
</pre>
</td></tr></table><p>






<H2>
    Output file format
</H2>

<!-- 
        This includes example output file formats.
        This should be a detailed description and example - assume
        someone will want to parse this file and will want to know what
        happens in unusual cases - null output, errors etc. 

        If you wish to include the standard description of the avalable
	report formats, use:
include file="inc/reportformats.ihtml"
   -->

The first line of <b>ffactor</b> output will contain the number of
species and the number of binary characters in the factored data set
followed by the letter "A" if the A option was specified in the
input. If option F was specified, the next line will begin
"FACTORS". If option A was specified, the line describing the ancestor
will follow next. Finally, the factored characters will be written for
each species in the format required for input by the other discrete
programs in the package. The maximum length of the output lines is 80
characters, but this maximum length can be changed prior to
compilation.

<p>
In fact, the format of the output file for the A and F options is not
correct for the current release of PHYLIP. We need to change their
output to write a factors file and an ancestors file instead of
putting the Factors and Ancestors information into the data file.


<p>


<a name="output.1"></a>
<h3>Output files for usage example </h3>
<p><h3>File: factor.ffactor</h3>
<table width="90%"><tr><td bgcolor="#CCFFCC">
<pre>
    4    8
Alpha     11100000
Beta      10001001
Gamma     00011100
Epsilon   11101010
</pre>
</td></tr></table><p>
<p><h3>File: factor.factor</h3>
<table width="90%"><tr><td bgcolor="#CCFFCC">
<pre>
</pre>
</td></tr></table><p>
<p><h3>File: factor.ancestor</h3>
<table width="90%"><tr><td bgcolor="#CCFFCC">
<pre>
</pre>
</td></tr></table><p>






<H2>
    Data files
</H2>

None

<H2>
    Notes
</H2>

<!-- 
        Restrictions.
        Interesting behaviour.
        Useful things you can do with this program.
   -->

None.







<H2>
    References
</H2>

<!-- 
        Bibliography for methods used.
   -->

None.








<H2>
    Warnings
</H2>

<!-- 
        Potentially stupid things the program will let you do.
   -->

None.







<H2>
    Diagnostic Error Messages
</H2>

<!-- 
        Error messages specific to this program, eg:
        "FATAL xxx" - means you have not set up the xxx data using program <b>prog</b>.<p>
   -->

<p>
The output should be checked for error messages. Errors will occur in
the character-state tree descriptions if the format is incorrect
(colons in the wrong place, etc.), if more than one root is specified,
if the tree contains loops (and hence is not a tree), and if the tree
is not connected, e.g.

<p>
<pre>

                             A:B B:C D:E
</pre>
<p>
describes 


<p>
<pre>
                  A ---- B ---- C          D ---- E
</pre>
<p>
This "tree" is in two unconnected pieces. An error will also occur if
a symbol appears in the data set that is not in the tree description
for that character. Blanks at the end of lines when the species
information is continued to a new line will cause this kind of error.


<H2>
    Exit status
</H2>

<!-- 
        Description of the exit status for various error conditions
   -->

It always exits with status 0.








<H2>
    Known bugs
</H2>


<!-- 
        Bugs noted but not yet fixed.
   -->

None.








<!--
<H2>
    See also
</H2>
-->
<h2><a name="See also">See also</a></h2>
<table border cellpadding=4 bgcolor="#FFFFF0">
<tr><th>Program name</th><th>Description</th></tr>
<tr><td><a href="../phylip/eclique.html">eclique</a></td><td>Largest clique program</td></tr>
<tr><td><a href="../phylip/edollop.html">edollop</a></td><td>Dollo and polymorphism parsimony algorithm</td></tr>
<tr><td><a href="../phylip/edolpenny.html">edolpenny</a></td><td>Penny algorithm Dollo or polymorphism</td></tr>
<tr><td><a href="../phylip/efactor.html">efactor</a></td><td>Multistate to binary recoding program</td></tr>
<tr><td><a href="../phylip/emix.html">emix</a></td><td>Mixed parsimony algorithm</td></tr>
<tr><td><a href="../phylip/epenny.html">epenny</a></td><td>Penny algorithm, branch-and-bound</td></tr>
<tr><td><a href="fclique.html">fclique</a></td><td>Largest clique program</td></tr>
<tr><td><a href="fdollop.html">fdollop</a></td><td>Dollo and polymorphism parsimony algorithm</td></tr>
<tr><td><a href="fdolpenny.html">fdolpenny</a></td><td>Penny algorithm Dollo or polymorphism</td></tr>
<tr><td><a href="fmix.html">fmix</a></td><td>Mixed parsimony algorithm</td></tr>
<tr><td><a href="fmove.html">fmove</a></td><td>Interactive mixed method parsimony</td></tr>
<tr><td><a href="fpars.html">fpars</a></td><td>Discrete character parsimony</td></tr>
<tr><td><a href="fpenny.html">fpenny</a></td><td>Penny algorithm, branch-and-bound</td></tr>
</table>

<!-- 
        Add any comments about other associated programs (to prepare
        data files?) that seealso doesn't find. 
   -->










<H2>
    Author(s)
</H2>

This program is an EMBOSS conversion of a program written by Joe
Felsenstein as part of his PHYLIP package.

<p>
Although we take every care to ensure that the results of the EMBOSS
version are identical to those from the original package, we recommend
that you check your inputs give the same results in both versions
before publication.

<p>
Please report all bugs in the EMBOSS version to the EMBOSS bug team,
not to the original author.


<H2>
    History
</H2>

Written (2004) - Joe Felsenstein, University of Washington.
<p>
Converted (August 2004) to an EMBASSY program by the EMBOSS team.




<H2>
    Target users
</H2>

<!--
        For general users, requested by one user, for EMBOSS site
        maintainers, for EMBOSS developers etc.
        eg:
        "This program is intended to be used by everyone and everything,
        from naive users to embedded scripts." 
	Which is easy to include using:
   -->

This program is intended to be used by everyone and everything, from naive users to embedded scripts.












</BODY>
</HTML>

